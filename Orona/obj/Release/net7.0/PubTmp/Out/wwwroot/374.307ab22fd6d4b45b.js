"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[374],{3374:(I,v,l)=>{l.r(v),l.d(v,{AuthenticationModule:()=>u});var p=l(6895),t=l(433),e=l(1571),Z=l(7361);class d{constructor(){this.validateConfirmPassword=i=>r=>{const a=r.value;if(""!==a)return a!==i.value?{mustMatch:!0}:null}}}d.\u0275fac=function(i){return new(i||d)},d.\u0275prov=e.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"});var f=l(3732);function _(o,i){if(1&o&&(e.TgZ(0,"div",21),e._UZ(1,"span",22),e.qZA()),2&o){const r=e.oxw();e.xp6(1),e.Q6J("innerHTML",r.errorMessage,e.oJD)}}function w(o,i){1&o&&(e.TgZ(0,"em"),e._uU(1,"Please provide a valid email"),e.qZA())}function U(o,i){1&o&&(e.TgZ(0,"em"),e._uU(1,"Email is required"),e.qZA())}function b(o,i){1&o&&(e.TgZ(0,"em"),e._uU(1,"Password is required"),e.qZA())}function T(o,i){1&o&&(e.TgZ(0,"em"),e._uU(1,"Confirmation is required"),e.qZA())}function C(o,i){1&o&&(e.TgZ(0,"em"),e._uU(1,"Passwords must match"),e.qZA())}class c{constructor(i,r,a){this.authService=i,this.passConfValidator=r,this.router=a,this.errorMessage="",this.validateControl=n=>this.registerForm.get(n).invalid&&this.registerForm.get(n).touched,this.hasError=(n,s)=>this.registerForm.get(n).hasError(s),this.registerUser=n=>{this.showError=!1;const s={...n};this.authService.registerUser("api/accounts/registration",{firstName:s.firstName,lastName:s.lastName,email:s.email,password:s.password,confirmPassword:s.confirm}).subscribe({next:m=>this.router.navigate(["/authentication/login"]),error:m=>{this.errorMessage=m.message,this.showError=!0}})}}ngOnInit(){this.registerForm=new t.cw({firstName:new t.NI(""),lastName:new t.NI(""),email:new t.NI("",[t.kI.required,t.kI.email]),password:new t.NI("",[t.kI.required]),confirm:new t.NI("")}),this.registerForm.get("confirm").setValidators([t.kI.required,this.passConfValidator.validateConfirmPassword(this.registerForm.get("password"))])}}function q(o,i){if(1&o&&(e.TgZ(0,"div",17),e._uU(1),e.qZA()),2&o){const r=e.oxw();e.xp6(1),e.hij(" ",r.errorMessage," ")}}function A(o,i){1&o&&(e.TgZ(0,"em"),e._uU(1,"Username is required"),e.qZA())}function N(o,i){1&o&&(e.TgZ(0,"em"),e._uU(1,"Password is required"),e.qZA())}c.\u0275fac=function(i){return new(i||c)(e.Y36(Z.$),e.Y36(d),e.Y36(f.F0))},c.\u0275cmp=e.Xpm({type:c,selectors:[["app-register-user"]],decls:45,vars:8,consts:[[1,"container"],[1,"card"],[1,"card-body"],[1,"card-title"],["class","alert alert-danger","role","alert",4,"ngIf"],["autocomplete","off","novalidate","",3,"formGroup","ngSubmit"],[1,"mb-3","row"],["for","firstName",1,"col-form-label","col-sm-2"],[1,"col-md-5"],["type","text","id","firstName","formControlName","firstName",1,"form-control"],["for","lastName",1,"col-form-label","col-sm-2"],["type","text","id","lastName","formControlName","lastName",1,"form-control"],["for","email",1,"col-form-label","col-sm-2"],["type","email","id","email","formControlName","email",1,"form-control"],[4,"ngIf"],["for","password",1,"col-form-label","col-sm-2"],["type","password","id","password","formControlName","password",1,"form-control"],["for","confirm",1,"col-form-label","col-sm-2"],["type","password","id","confirm","formControlName","confirm",1,"form-control"],[1,"col-md-1"],["type","submit",1,"btn","btn-primary",3,"disabled"],["role","alert",1,"alert","alert-danger"],[3,"innerHTML"]],template:function(i,r){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e._uU(4,"Register"),e.qZA(),e.YNc(5,_,2,1,"div",4),e.TgZ(6,"form",5),e.NdJ("ngSubmit",function(){return r.registerUser(r.registerForm.value)}),e.TgZ(7,"div",6)(8,"label",7),e._uU(9,"First Name:"),e.qZA(),e.TgZ(10,"div",8),e._UZ(11,"input",9),e.qZA()(),e.TgZ(12,"div",6)(13,"label",10),e._uU(14,"Last Name:"),e.qZA(),e.TgZ(15,"div",8),e._UZ(16,"input",11),e.qZA()(),e.TgZ(17,"div",6)(18,"label",12),e._uU(19,"Email:"),e.qZA(),e.TgZ(20,"div",8),e._UZ(21,"input",13),e.qZA(),e.TgZ(22,"div",8),e.YNc(23,w,2,0,"em",14),e.YNc(24,U,2,0,"em",14),e.qZA()(),e.TgZ(25,"div",6)(26,"label",15),e._uU(27,"Password:"),e.qZA(),e.TgZ(28,"div",8),e._UZ(29,"input",16),e.qZA(),e.TgZ(30,"div",8),e.YNc(31,b,2,0,"em",14),e.qZA()(),e.TgZ(32,"div",6)(33,"label",17),e._uU(34,"Confirm Password:"),e.qZA(),e.TgZ(35,"div",8),e._UZ(36,"input",18),e.qZA(),e.TgZ(37,"div",8),e.YNc(38,T,2,0,"em",14),e.YNc(39,C,2,0,"em",14),e.qZA()(),e._UZ(40,"br"),e.TgZ(41,"div",6)(42,"div",19)(43,"button",20),e._uU(44,"Register"),e.qZA()()()()()()()),2&i&&(e.xp6(5),e.Q6J("ngIf",r.showError),e.xp6(1),e.Q6J("formGroup",r.registerForm),e.xp6(17),e.Q6J("ngIf",r.validateControl("email")&&r.hasError("email","email")),e.xp6(1),e.Q6J("ngIf",r.validateControl("email")&&r.hasError("email","required")),e.xp6(7),e.Q6J("ngIf",r.validateControl("password")&&r.hasError("password","required")),e.xp6(7),e.Q6J("ngIf",r.validateControl("confirm")&&r.hasError("confirm","required")),e.xp6(1),e.Q6J("ngIf",r.hasError("confirm","mustMatch")),e.xp6(4),e.Q6J("disabled",!r.registerForm.valid))},dependencies:[p.O5,t._Y,t.Fj,t.JJ,t.JL,t.sg,t.u],styles:["em[_ngcontent-%COMP%]{color:#e71515;font-weight:700}.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:red}.card[_ngcontent-%COMP%]{margin-top:10px;background-color:#fff;box-shadow:1px 1px 1px #cabcbc}"]});class g{constructor(i,r,a){this.authService=i,this.router=r,this.route=a,this.errorMessage="",this.validateControl=n=>this.loginForm.get(n).invalid&&this.loginForm.get(n).touched,this.hasError=(n,s)=>this.loginForm.get(n).hasError(s),this.loginUser=n=>{this.showError=!1;const s={...n};this.authService.loginUser("api/accounts/login",{email:s.username,password:s.password}).subscribe({next:m=>{localStorage.setItem("token",m.token),this.authService.sendAuthStateChangeNotification(m.isAuthSuccessful),this.authService.isUserAdmin()&&this.authService.sendIsUserAdminNotification(!0),this.router.navigate([this.returnUrl])},error:m=>{this.errorMessage=m.message,this.showError=!0}})}}ngOnInit(){this.loginForm=new t.cw({username:new t.NI("",[t.kI.required]),password:new t.NI("",[t.kI.required])}),this.returnUrl=this.route.snapshot.queryParams.returnUrl||"/"}navigateToRegister(){this.router.navigate(["/authentication/register"])}}g.\u0275fac=function(i){return new(i||g)(e.Y36(Z.$),e.Y36(f.F0),e.Y36(f.gz))},g.\u0275cmp=e.Xpm({type:g,selectors:[["app-login"]],decls:31,vars:5,consts:[[1,"container"],[1,"card"],[1,"card-body"],[1,"card-title"],["class","alert alert-danger","role","alert",4,"ngIf"],["autocomplete","off","novalidate","",3,"formGroup","ngSubmit"],[1,"mb-3","row"],["for","username",1,"col-form-label","col-sm-2"],[1,"col-md-5"],["type","text","id","username","formControlName","username",1,"form-control"],[4,"ngIf"],["for","password",1,"col-form-label","col-sm-2"],["type","password","id","password","formControlName","password",1,"form-control"],["id","buttons"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"ms-5"],[1,"btn","btn-link",3,"click"],["role","alert",1,"alert","alert-danger"]],template:function(i,r){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e._uU(4,"Login"),e.qZA(),e.YNc(5,q,2,1,"div",4),e.TgZ(6,"form",5),e.NdJ("ngSubmit",function(){return r.loginUser(r.loginForm.value)}),e.TgZ(7,"div",6)(8,"label",7),e._uU(9,"Username:"),e.qZA(),e.TgZ(10,"div",8),e._UZ(11,"input",9),e.qZA(),e.TgZ(12,"div",8),e.YNc(13,A,2,0,"em",10),e.qZA()(),e.TgZ(14,"div",6)(15,"label",11),e._uU(16,"Password:"),e.qZA(),e.TgZ(17,"div",8),e._UZ(18,"input",12),e.qZA(),e.TgZ(19,"div",8),e.YNc(20,N,2,0,"em",10),e.qZA()(),e._UZ(21,"br"),e.TgZ(22,"div",13)(23,"div")(24,"button",14),e._uU(25," Login "),e.qZA()(),e.TgZ(26,"div")(27,"p",15),e._uU(28," No account? "),e.TgZ(29,"button",16),e.NdJ("click",function(){return r.navigateToRegister()}),e._uU(30," Register! "),e.qZA()()()()()()()()),2&i&&(e.xp6(5),e.Q6J("ngIf",r.showError),e.xp6(1),e.Q6J("formGroup",r.loginForm),e.xp6(7),e.Q6J("ngIf",r.validateControl("username")&&r.hasError("username","required")),e.xp6(7),e.Q6J("ngIf",r.validateControl("password")&&r.hasError("password","required")),e.xp6(4),e.Q6J("disabled",!r.loginForm.valid))},dependencies:[p.O5,t._Y,t.Fj,t.JJ,t.JL,t.sg,t.u],styles:["em[_ngcontent-%COMP%]{color:#e71515;font-weight:700}.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:red}.card[_ngcontent-%COMP%]{margin-top:10px;background-color:#fff;box-shadow:1px 1px 1px #cabcbc}#buttons[_ngcontent-%COMP%]{display:flex}"]});class u{}u.\u0275fac=function(i){return new(i||u)},u.\u0275mod=e.oAB({type:u}),u.\u0275inj=e.cJS({imports:[p.ez,t.UX,f.Bz.forChild([{path:"register",component:c},{path:"login",component:g}])]})}}]);